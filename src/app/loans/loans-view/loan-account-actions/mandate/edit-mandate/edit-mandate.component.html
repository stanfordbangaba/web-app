<div class="container">

  <mat-card>

    <form [formGroup]="mandateForm" (ngSubmit)="submit()">

      <mat-card-content>

        <div fxLayout="column">

          <mat-form-field>
            <mat-label>First Collection Date</mat-label>
            <input matInput [min]="minDate" [matDatepicker]="firstCollectionDay" required formControlName="firstCollectionDay">
            <mat-datepicker-toggle matSuffix [for]="firstCollectionDay"></mat-datepicker-toggle>
            <mat-datepicker #firstCollectionDay></mat-datepicker>
            <mat-error *ngIf="mandateForm.controls.firstCollectionDay.hasError('required')">
              First Collection Date is <strong>required</strong>
            </mat-error>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Collection Day</mat-label>
            <input type="number" matInput required formControlName="collectionDay">
            <mat-error *ngIf="mandateForm.controls.collectionDay.hasError('required')">
              Collection Day is <strong>required</strong>
            </mat-error>
          </mat-form-field>

          <mat-form-field>
            <mat-label>First Collection Amount</mat-label>
            <input type="number" matInput required formControlName="firstCollectionAmount">
            <mat-error *ngIf="mandateForm.controls.firstCollectionAmount.hasError('required')">
              First Collection Amount is <strong>required</strong>
            </mat-error>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Collection Amount</mat-label>
            <input type="number" matInput required formControlName="collectionAmount">
            <mat-error *ngIf="mandateForm.controls.collectionAmount.hasError('required')">
              Collection Amount is <strong>required</strong>
            </mat-error>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Maximum Collection Amount</mat-label>
            <input type="number" matInput required formControlName="maximumCollectionAmount">
            <mat-error *ngIf="mandateForm.controls.maximumCollectionAmount.hasError('required')">
              Maximum Collection Amount is <strong>required</strong>
            </mat-error>
          </mat-form-field>


          <mat-checkbox labelPosition="before" formControlName="trackingIndicator" class="tracking-indicator">
            Enable Tracking Indicator
          </mat-checkbox>

          <mat-form-field>
            <mat-label>Date</mat-label>
            <!--            <input matInput [min]="minDate" [max]="maxDate" [matDatepicker]="startDatePicker" required formControlName="startDate">-->
            <input matInput [min]="minDate" [matDatepicker]="startDatePicker" required formControlName="date">
            <mat-datepicker-toggle matSuffix [for]="startDatePicker"></mat-datepicker-toggle>
            <mat-datepicker #startDatePicker></mat-datepicker>
            <mat-error *ngIf="mandateForm.controls.date.hasError('required')">
              Date is <strong>required</strong>
            </mat-error>
          </mat-form-field>


        <mat-form-field *ngIf="mandateForm.contains('bankCode')" fxFlex="48%">
          <mat-label>Bank</mat-label>
          <mat-select required formControlName="bankCode">
            <mat-option *ngFor="let bank of bankOptions" [value]="bank.code">
              {{ bank.name }}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="mandateForm.controls.bankCode.hasError('required')">
            Bank is <strong>required</strong>
          </mat-error>
        </mat-form-field>

        <mat-form-field>
          <mat-label>Account Name</mat-label>
          <input matInput required formControlName="debtorAccountName">
          <mat-error *ngIf="mandateForm.controls.debtorAccountName.hasError('required')">
            Account Name is <strong>required</strong>
          </mat-error>
        </mat-form-field>


        <mat-form-field>
          <mat-label>Account Number</mat-label>
          <input matInput required formControlName="debtorAccountNumber">
          <mat-error *ngIf="mandateForm.controls.debtorAccountNumber.hasError('required')">
            Account Number is <strong>required</strong>
          </mat-error>
        </mat-form-field>


        <mat-form-field fxFlex="48%">
          <mat-label>Reason</mat-label>
          <mat-select formControlName="reason">
            <mat-option *ngFor="let reason of externalCodes" [value]="reason.code">
              {{ reason.value }}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="mandateForm.controls.reason.hasError('required')">
            Reason is <strong>required</strong>
          </mat-error>
        </mat-form-field>


        </div>

      </mat-card-content>


      <mat-card-actions fxLayout="row" fxLayout.xs="column" fxLayoutAlign="center" fxLayoutGap="5px">
        <button type="button" mat-raised-button [routerLink]="['../../mandate', mandateData.id, 'details']">Cancel</button>
        <button mat-raised-button color="primary" [disabled]="!mandateForm.valid" *mifosxHasPermission="'CREATE_DEBIT_ORDER_MANDATE'">Submit</button>
      </mat-card-actions>

    </form>

  </mat-card>

</div>


